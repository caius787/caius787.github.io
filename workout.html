<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitness Planner & Tracker</title>
    <style>
        /* Reset some default styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 50px;
            position: relative;
        }

        /* Main Box Styling */
        .main-box {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 600px;
            position: relative;
            cursor: default;
        }

        /* Workout Section */
        .workout-section {
            margin-bottom: 20px;
        }

        .workout-section h2 {
            text-align: center;
            margin-bottom: 15px;
        }

        .workout-list {
            list-style: none;
        }

        .workout-list li {
            padding: 10px;
            background-color: #f9f9f9;
            margin-bottom: 10px;
            border-left: 5px solid #28a745;
            border-radius: 5px;
            transition: background-color 0.3s;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .workout-list li:hover {
            background-color: #e9e9e9;
        }

        .workout-list li input[type="checkbox"] {
            margin-right: 10px;
            cursor: pointer;
        }

        /* Timer Section */
        .timer-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 250px;
            padding: 20px;
            background-color: #fff;
            border: 2px solid #28a745;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: move;
            z-index: 10;
        }

        .timer-header h2 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .timer-display {
            font-size: 2em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 10px;
        }

        .timer-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .timer-button {
            padding: 3px 5px;
            font-size: 0.9em;
            cursor: pointer;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .timer-button:hover:not(:disabled) {
            background-color: #218838;
        }

        .timer-button:disabled {
            background-color: #94d3a2;
            cursor: not-allowed;
        }

        /* Draggable Cursor Change */
        .timer-box.dragging {
            opacity: 0.7;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .timer-box {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>

    <!-- Main Box -->
    <div class="main-box" id="mainBox">
        <!-- Workout Section -->
        <div class="workout-section">
            <h2>Today's Workout: <span id="workoutType">Loading...</span></h2>
            <ul class="workout-list" id="workoutList">
                <!-- Workouts will be dynamically inserted here -->
            </ul>
        </div>
    </div>

    <!-- Timer Box -->
    <div class="timer-box" id="timerBox">
        <div class="timer-header">
            <h2>Timer</h2>
        </div>
        <div class="timer-display">
            <!-- Minutes Section -->
            <div class="timer-section">
                <button class="timer-button" id="incMin">+</button>
                <span id="minutes">00</span>
                <button class="timer-button" id="decMin">-</button>
            </div>
            :
            <!-- Seconds Section -->
            <div class="timer-section">
                <button class="timer-button" id="incSec">+</button>
                <span id="seconds">00</span>
                <button class="timer-button" id="decSec">-</button>
            </div>
        </div>
        <div class="timer-controls">
            <button class="timer-button" onclick="startTimer()" id="startBtn">Start</button>
            <button class="timer-button" onclick="resetTimer()" id="resetBtn">Reset</button>
        </div>
    </div>

    <!-- Audio Element for Ding Sound -->
    <audio id="dingSound" src="ding.mp3" preload="auto"></audio>

    <script>
        // Define workout cycle starting with Legs as today
        const cycle = ["Legs", "Arms", "Core", "Legs", "Arms", "Rest Day", "Rest Day"];

        function getTodayWorkout() {
            const dayIndex = (new Date()).getDay();
            return cycle[dayIndex];
        }

        function initializeWorkouts() {
            const workoutList = document.getElementById("workoutList");
            workoutList.innerHTML = "";
            const workoutType = getTodayWorkout();
            document.getElementById("workoutType").textContent = workoutType;

            const exercises = {
                "Legs": ["10 Lunges per Leg with Weight", "3x10 Squats", "4x20 Calf Raises", "3x10 Elastic Leg Extensions", "6x10 Side Leg Lifts"],
                "Arms": ["6x10 Bicep Curls", "6x10 Tricep Curls", "2x10 Pushups", "1:30 Hold", "3x10 Shoulder Lifts"],
                "Core": ["60 Situps with Weights", "2:04 Plank", "3x10 Seconds Superman", "3x20 Flutter Kicks", "3x10 Lie Down Thrust"],
                "Rest Day": ["Rest and recover."]
            };

            exercises[workoutType].forEach((exercise, index) => {
                const li = document.createElement("li");
                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.id = `workout-${index}`;
                checkbox.style.marginRight = "10px";
                li.appendChild(checkbox);
                li.appendChild(document.createTextNode(exercise));
                workoutList.appendChild(li);

                li.addEventListener('click', e => {
                    if (e.target.tagName !== 'INPUT') checkbox.checked = !checkbox.checked;
                });
            });
        }

        // Timer Variables
        let timerInterval, totalSeconds = 0, isTimerRunning = false;

        // Elements
        const timerDisplay = document.getElementById("timerDisplay");
        const startBtn = document.getElementById("startBtn");
        const resetBtn = document.getElementById("resetBtn");
        const dingSound = document.getElementById("dingSound");
        const minutesSpan = document.getElementById("minutes");
        const secondsSpan = document.getElementById("seconds");
        const timerBox = document.getElementById("timerBox");

        function updateTimerDisplay() {
            const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
            const seconds = String(totalSeconds % 60).padStart(2, '0');
            minutesSpan.textContent = minutes;
            secondsSpan.textContent = seconds;
        }

        function startTimer() {
            if (isTimerRunning || totalSeconds <= 0) return;
            isTimerRunning = true;
            disableAdjustments();

            dingSound.volume = 1.0; // Ensure sound permission

            timerInterval = setInterval(() => {
                if (--totalSeconds < 0) {
                    clearInterval(timerInterval);
                    dingSound.play();
                    isTimerRunning = false;
                    enableAdjustments();
                } else updateTimerDisplay();
            }, 1000);
        }

        function resetTimer() {
            clearInterval(timerInterval);
            totalSeconds = 0;
            isTimerRunning = false;
            enableAdjustments();
            updateTimerDisplay();
        }

        function disableAdjustments() {
            document.querySelectorAll('.timer-section button').forEach(button => button.disabled = true);
            startBtn.disabled = true;
            resetBtn.disabled = false;
        }

        function enableAdjustments() {
            document.querySelectorAll('.timer-section button').forEach(button => button.disabled = false);
            startBtn.disabled = false;
            resetBtn.disabled = false;
        }

        // Timer adjustment buttons
        document.getElementById("incMin").addEventListener('click', () => {
            if (isTimerRunning) return;
            totalSeconds = Math.min(totalSeconds + 60, 3599);
            updateTimerDisplay();
        });

        document.getElementById("decMin").addEventListener('click', () => {
            if (isTimerRunning) return;
            totalSeconds = Math.max(totalSeconds - 60, 0);
            updateTimerDisplay();
        });

        document.getElementById("incSec").addEventListener('click', () => {
            if (isTimerRunning) return;
            totalSeconds = Math.min(totalSeconds + 1, 3599);
            updateTimerDisplay();
        });

        document.getElementById("decSec").addEventListener('click', () => {
            if (isTimerRunning) return;
            totalSeconds = Math.max(totalSeconds - 1, 0);
            updateTimerDisplay();
        });

        // Draggable functionality
        let isDraggingTimer = false;
        let dragOffsetXTimer = 0;
        let dragOffsetYTimer = 0;

        timerBox.addEventListener('mousedown', (e) => {
            if (e.target === timerBox || e.target.closest('.timer-header, .timer-display')) {
                isDraggingTimer = true;
                dragOffsetXTimer = e.clientX - timerBox.offsetLeft;
                dragOffsetYTimer = e.clientY - timerBox.offsetTop;
                timerBox.classList.add('dragging');
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDraggingTimer) {
                let left = e.clientX - dragOffsetXTimer;
                let top = e.clientY - dragOffsetYTimer;
                left = Math.max(0, Math.min(left, window.innerWidth - timerBox.offsetWidth));
                top = Math.max(0, Math.min(top, window.innerHeight - timerBox.offsetHeight));
                timerBox.style.left = `${left}px`;
                timerBox.style.top = `${top}px`;
            }
        });

        document.addEventListener('mouseup', () => {
            if (isDraggingTimer) {
                isDraggingTimer = false;
                timerBox.classList.remove('dragging');
            }
        });

        window.onload = initializeWorkouts;
    </script>

</body>
</html>